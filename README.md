# Пример автоматических Ui тестов

## Установка и запуск

- Собрать проект Build
- Запустить сервер на localhost порт 80 (отдельный проект, либо Tdms.Server.Host.exe)
- Открыть вкладку тестов: меню Test->Test Explorer
- Выбрать и запустить SimpleTests правой кнопкой Run.

## Проверка результатов

- В результате запуска тестов должен открыться браузер, открыться страница Tdms http://localhost/client/, выполниться тесты и закрыться браузер
- В TestExplorer успешные тесты будут подсвечены зеленым, не успешные красным

## Обработка ошибок

- Сообщение об ошибке читать снизу вверх. Снизу будет компонент который был не найден, вызвал ошибку
- В случае ошибки поставить точку остановки вначале функции теста, выбрать тест в TestExplorer, и запустить Debug. Выполнив построчно получим строчку с ошибкой

## Тесты Elaros

- Для успешного выполнения тестов Elaros*, необходимо запустить тесты подключившись к серверу со стандартной базой Elaros, созданной классическим клиентом

## FAQ

- Не устанавливаются пакеты nuget?
Открыть менеджер пакетов "Manage Nuget packages..." вызвать свойства ("Options") и включить/проверить источник "local" (tdms.automatic.ui\nuget.packages)
 
- Где задается имя сервера для тестирования?
Имя сервера задается в классе BaseTest.cs в свойстве PageAddress

- Как проверить, что компонент найден?
У WebComponent метод IsAvailable() - непосредственно в этот момент попробует найти в DOM.

- Не ищется атрибут как InputComponent?
Атрибут может быть разными классами: 
+ a) InputComponent(однострочный текст +- кнопка) 
+ b) TextAreaComponent - многострочный текст
+ c) Html/Markdown пока не поддерживается фреймворком

- Не ищется компонент по тексту?
Может быть проблема с русскими/английскими буквами, либо текст не полностью отображен. Для решения найти и скопировать текст из DOM браузера 

- Где настраиваются таймауты ожидания создания/обновления компонентов по умолчанию?
В SetDefaultConfiguration в классе BaseTest

- Как получить определенный элемент в DOM?
Элемент получается с помощью построителя(билдера) запроса к DOM дереву. Например у WebComponent есть методы GetComponent/GetComponents,
которые начинают создание запроса, далее следует условие типа ByText/BySystemIdentifier и в конце Build(). 
Пример:
``` TreeViewItemComponent rootTreeItem = mainTreeView.GetComponent<TreeViewItemComponent>().ByText("Папка документации").Build(); ```
rootTreeItem - это построенный по уловиям запрос, а не конкретный элемент в дереве. Чтобы проверить существование элемента нужно вызвать
``` rootTreeItem.ShouldAvailable(); ```
который выкинеть exception, если элемент в DOM не найден в течение времени ожидания.


- Какой метод использовать для поиска одного элемента?
GetCell, GetItem, GetComponent - создают запрос одного элемента. GetCells, GetItems, GetComponents - всегда возвращают коллекцию.

- В диспетчере задач при отладке тестов и остановке их через студию остаются процессы chromedriver.exe?
Известная ошибка, необходимо закрыть их руками в диспетчере задач, это не повлияет на основной chrome